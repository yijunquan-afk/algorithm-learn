# 前缀和

为方便描述，把 nums 记作 a。

对于数组 a，定义它的前缀和

$$
s[0] = 0 \\
s[1] = a[0] \\
s[2] = a[0] + a[1] \\
\vdots \\
s[i] = a[0] + a[1] + \cdots + a[i - 1] = \sum_{j=0}^{i-1} nums[j] \\
s[i + 1] = a[0] + a[1] + \cdots + a[i - 1] + a[i] = \sum_{j=0}^{i} nums[j] \\
\vdots \\
s[n]=a[0]+a[1]+\cdots+a[n-1]
$$
根据这个定义，有

$$
s[i + 1] = s[i] + a[i]
$$

示例中的数组$[-2, 0, 3, -5, 2, -1]$，对应的前缀和数组$s = [0, -2, -2, 1, -4, -2, -3]$。

通过前缀和，我们==可以把连续子数组的元素和转换成两个前缀和的差==，$a[\text{left}]$ 到$a[\text{right}$的元素和等于

$$
\sum_{j=\text{left}}^{\text{right}} a[j] = \sum_{j=0}^{\text{right}} a[j] - \sum_{j=0}^{\text{left}-1} a[j] = s[\text{right} + 1] - s[\text{left}]
$$
有了这个式子，示例中子数组$[3, -5, 2, -1]$的和，就可以以$O(1)$地用$s[6] - s[2] = -3 - (-2) = -1$算出来。

## 答疑

**问**：为什么要定义$s[0] = 0$，这样做有什么好处？

**答**：如果$left = 0$，要计算的子数组是一个前缀（从$a[0]$到$a[right]$），我们要用$s[right + 1]$减去$s[0]$。如果不定义$s[0] = 0$，就必须特判$left = 0$的情况了（读者可以试试）。通过定义$s[0] = 0$，任意子数组（包括前缀）都可以表示为两个前缀和的差。此外，如果$a$是空数组，定义$s[0] = 0$的写法是可以兼容这种情况的。